<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnóstico de Ferramentas e Processos</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; background: #002D54; color: #333; }
        .card { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); max-width: 600px; width: 90%; text-align: center; }
        .hidden { display: none; }
        h2 { color: #002D54; margin-bottom: 20px; font-weight: bold; }
        p { line-height: 1.6; font-size: 1.1em; color: #444; }
        input { padding: 12px; width: 90%; margin-bottom: 20px; border: 2px solid #ddd; border-radius: 6px; font-size: 16px; }
        .btn-group { display: flex; justify-content: center; gap: 15px; margin-top: 20px; }
        button { padding: 15px 30px; cursor: pointer; border: none; border-radius: 6px; font-weight: bold; font-size: 16px; transition: 0.3s; }
        .btn-next { background: #002D54; color: white; width: 100%; }
        .btn-sim { background: #1D8348; color: white; flex: 1; }
        .btn-nao { background: #A93226; color: white; flex: 1; }
        #result-text { text-align: left; background: #f8f9fa; padding: 25px; border-left: 6px solid #002D54; margin-top: 20px; border-radius: 4px; }
        .progress { font-size: 0.9em; color: #888; margin-bottom: 10px; font-weight: bold; }
        .block-tag { font-size: 0.75em; color: #002D54; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }
    </style>
</head>
<body>

    <div class="card">
        <div id="step-name">
            <h2>Diagnóstico de Ferramentas</h2>
            <p>Vamos descobrir a melhor ferramenta para sua necessidade. Responda as perguntas a seguir com SIM ou NÃO de acordo com sua necessidade.</p>
            <input type="text" id="userName" placeholder="Informe seu nome completo">
            <button class="btn-next" onclick="startFlow()">Começar</button>
        </div>

        <div id="step-questions" class="hidden">
            <div id="block-name" class="block-tag"></div>
            <div id="progress" class="progress"></div>
            <h3 id="question-text" style="min-height: 100px; display: flex; align-items: center; justify-content: center;">...</h3>
            <div class="btn-group">
                <button class="btn-sim" onclick="handleAnswer(true)">Sim</button>
                <button class="btn-nao" onclick="handleAnswer(false)">Não</button>
            </div>
        </div>

        <div id="step-result" class="hidden">
            <h2 id="result-title"></h2>
            <div id="result-text"></div>
            
            <div id="calendar-area" class="hidden">
                <p style="margin-top: 25px; font-weight: bold;">Deseja detalhar este projeto?</p>
                <a href="https://outlook.office.com/bookwithme/user/fec3fc9171ab43869839ccfbf768b3e9@goldpao.com/meetingtype/fvmFuyerekKxbcV2HkZ2lQ2?anonymous&ismsaljsauthenabled&ep=mlink" target="_blank">
                    <button class="btn-next">Agendar reunião com Alexandre</button>
                </a>
            </div>
            
            <p id="sending-status" style="font-size: 11px; color: #999; margin-top: 20px;"></p>
            <button class="btn-next" style="margin-top:20px; background: #666;" onclick="location.reload()">Refazer Teste</button>
        </div>
    </div>

    <script>
        let solicitante = "";
        let currentQuestion = 0;
        let answers = [];

        const questions = [
            { b: "BLOCO 1 — NATUREZA DO PROBLEMA", q: "O principal problema hoje é receber solicitações por vários canais diferentes?" },
            { b: "BLOCO 1 — NATUREZA DO PROBLEMA", q: "Depois que a solicitação é recebida, o trabalho não depende de uma sequência fixa de etapas?" },
            { b: "BLOCO 1 — NATUREZA DO PROBLEMA", q: "Cada solicitação costuma exigir análise ou tratamento diferente?" },
            { b: "BLOCO 2 — ATENDIMENTO", q: "As solicitações entram em fila e alguém da equipe assume o atendimento?" },
            { b: "BLOCO 2 — ATENDIMENTO", q: "O mais importante é saber quem está atendendo a solicitação agora?" },
            { b: "BLOCO 2 — ATENDIMENTO", q: "O sucesso depende mais de cumprir prazo (SLA) do que de seguir etapas?" },
            { b: "BLOCO 3 — FLUXO ORQUESTRADO", q: "A maioria das solicitações segue as mesmas etapas, na mesma ordem?" },
            { b: "BLOCO 3 — FLUXO ORQUESTRADO", q: "O sistema precisa impedir o avanço da solicitação se alguma regra não for cumprida?" },
            { b: "BLOCO 3 — FLUXO ORQUESTRADO", q: "O sistema precisa avisar automaticamente quando uma etapa termina?" },
            { b: "BLOCO 4 — MATURIDADE E ESCALA", q: "Pessoas diferentes executam esse trabalho de forma parecida?" },
            { b: "BLOCO 4 — MATURIDADE E ESCALA", q: "O volume ou a criticidade do processo justifica o uso de um sistema dedicado?" },
            { b: "BLOCO 4 — MATURIDADE E ESCALA", q: "Manter esse processo de forma manual hoje gera mais problema do que benefício?" }
        ];

        function startFlow() {
            solicitante = document.getElementById('userName').value;
            if (!solicitante.trim()) { alert("Informe seu nome."); return; }
            document.getElementById('step-name').classList.add('hidden');
            document.getElementById('step-questions').classList.remove('hidden');
            updateQuestion();
        }

        function updateQuestion() {
            if (currentQuestion < questions.length) {
                document.getElementById('block-name').innerText = questions[currentQuestion].b;
                document.getElementById('progress').innerText = `Questão ${currentQuestion + 1} de 12`;
                document.getElementById('question-text').innerText = questions[currentQuestion].q;
            } else { showResult(); }
        }

        function handleAnswer(val) {
            answers.push(val);
            currentQuestion++;
            updateQuestion();
        }

        async function sendToFormspree(resultLabel) {
            const url = "https://formspree.io/f/xlgjerob";
            let data = { Solicitante: solicitante, Resultado: resultLabel };
            questions.forEach((item, index) => {
                data[`P${index + 1}_${item.q.substring(0, 30)}...`] = answers[index] ? "SIM" : "NÃO";
            });

            try {
                await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
                    body: JSON.stringify(data)
                });
                document.getElementById('sending-status').innerText = "Dados enviados para análise de processos.";
            } catch (e) { }
        }

        function showResult() {
            document.getElementById('step-questions').classList.add('hidden');
            document.getElementById('step-result').classList.remove('hidden');
            
            const title = document.getElementById('result-title');
            const text = document.getElementById('result-text');
            const cal = document.getElementById('calendar-area');

            const a = (i) => answers[i-1];
            const sumSim = (start, end) => answers.slice(start-1, end).filter(x => x).length;

            let res = "";

            // LÓGICA PRIORITÁRIA: MANUAL
            if (a(11) === false && a(12) === false) {
                res = "Manual / E-mail";
                title.innerText = res;
                text.innerHTML = "De acordo com as respostas, não justifica nenhum tipo de automação para o processo ou tarefa. O impacto e risco são baixos para o investimento necessário.";
            }
            // REDESENHAR
            else if (a(7) === false || a(10) === false) {
                res = "Redesenhar antes de automatizar";
                title.innerText = res;
                text.innerHTML = "O fluxo ainda não está claro ou padronizado. É necessário organizar as etapas antes de buscar tecnologia.";
                cal.classList.remove('hidden');
            }
            // MELHORAR PROCESSO
            else if (a(7) === true && (a(10) === false || a(12) === false)) {
                res = "Melhorar processo";
                title.innerText = res;
                text.innerHTML = "Existe um fluxo, mas ele ainda é instável ou gera custo operacional excessivo sem padronização.";
                cal.classList.remove('hidden');
            }
            // ZEEV BPM (REGRAS RÍGIDAS)
            else if (a(1) === false && a(2) === false && a(3) === false && sumSim(4, 6) <= 1 && sumSim(7, 9) === 3 && a(10) && a(11) && a(12)) {
                res = "Zeev BPM";
                title.innerText = res;
                text.innerHTML = "Fluxo orquestrado e maduro identificado. Necessidade de controle rígido e repetição de etapas sequenciais.";
                cal.classList.remove('hidden');
            }
            // MOVIDESK
            else if (sumSim(4, 6) >= 2 && sumSim(8, 9) <= 1 && a(11)) {
                res = "Movidesk / Service Desk";
                title.innerText = res;
                text.innerHTML = "Foco em gestão de atendimentos, filas de equipe e cumprimento de prazos (SLA).";
                cal.classList.remove('hidden');
            }
            // FORMS
            else if (a(1) === true && (a(2) || a(3)) && sumSim(7, 9) <= 1 && a(11)) {
                res = "Forms";
                title.innerText = "Microsoft Forms";
                text.innerHTML = "A centralização da entrada de dados é suficiente para organizar seu processo neste momento.";
                cal.classList.remove('hidden');
            }
            else {
                res = "Avaliação Consultiva";
                title.innerText = res;
                text.innerHTML = "As respostas sugerem um cenário misto. Recomenda-se uma análise detalhada com o gestor de processos.";
                cal.classList.remove('hidden');
            }

            sendToFormspree(res);
        }
    </script>
</body>
</html>

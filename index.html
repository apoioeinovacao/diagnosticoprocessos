<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√Årvore de Decis√£o - Processos</title>
    <style>
        :root { --azul-netuno: #1B2631; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: var(--azul-netuno); 
            color: #333; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
        }
        .card { 
            background: white; 
            padding: 40px; 
            border-radius: 12px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); 
            max-width: 600px; 
            width: 90%; 
            text-align: center; 
        }
        .hidden { display: none !important; }
        h2 { color: var(--azul-netuno); margin-bottom: 20px; }
        p { line-height: 1.6; color: #555; }
        .block-tag { font-size: 0.75em; color: #7f8c8d; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; }
        .question-text { min-height: 100px; display: flex; align-items: center; justify-content: center; font-size: 1.15em; font-weight: 500; }
        input, textarea { padding: 15px; width: 100%; margin-bottom: 20px; border: 2px solid #ddd; border-radius: 6px; box-sizing: border-box; font-family: inherit; font-size: 16px; }
        .btn-group { display: flex; justify-content: center; gap: 15px; margin-top: 25px; }
        button { padding: 15px 30px; cursor: pointer; border: none; border-radius: 6px; font-weight: bold; font-size: 16px; transition: 0.3s; }
        .btn-next { background: var(--azul-netuno); color: white; width: 100%; }
        .btn-sim { background: #1D8348; color: white; flex: 1; }
        .btn-nao { background: #A93226; color: white; flex: 1; }
        #result-display { 
            text-align: left; 
            background: #f8f9fa; 
            padding: 25px; 
            border-left: 6px solid var(--azul-netuno); 
            margin-top: 20px; 
            border-radius: 4px; 
        }
        .status { font-size: 11px; color: #999; margin-top: 20px; }
    </style>
</head>
<body>

<div class="card">
    <div id="step-start">
        <h2>√Årvore de Decis√£o - Processos</h2>
        <p>Responda √†s perguntas para melhor entendermos a necessidade de automa√ß√£o do seu processo.</p>
        <input type="text" id="userName" placeholder="Informe seu nome completo">
        <button class="btn-next" onclick="startFlow()">Iniciar Diagn√≥stico</button>
    </div>

    <div id="step-questions" class="hidden">
        <div id="block-name" class="block-tag"></div>
        <div id="question-text" class="question-text"></div>
        
        <div id="area-sim-nao" class="btn-group hidden">
            <button class="btn-sim" onclick="handleAnswer(true)">SIM</button>
            <button class="btn-nao" onclick="handleAnswer(false)">N√ÉO</button>
        </div>

        <div id="area-discursiva" class="hidden">
            <textarea id="open-answer" rows="4" placeholder="Escreva sua resposta aqui..."></textarea>
            <button class="btn-next" onclick="handleOpenAnswer()">Continuar</button>
        </div>
    </div>

    <div id="step-result" class="hidden">
        <h2 id="result-title"></h2>
        <div id="result-display">
            <p id="result-text"></p>
        </div>
        
        <div id="calendar-area" class="hidden">
            <p style="margin-top: 25px; font-weight: bold;">Deseja detalhar este projeto?</p>
            <a href="https://outlook.office.com/bookwithme/user/fec3fc9171ab43869839ccfbf768b3e9@goldpao.com/meetingtype/fvmFuyerekKxbcV2HkZ2lQ2?anonymous&ismsaljsauthenabled&ep=mlink" target="_blank">
                <button class="btn-next">Agendar reuni√£o com Alexandre</button>
            </a>
        </div>
        
        <p id="sending-status" class="status"></p>
        <button class="btn-next" style="margin-top:20px; background: #666;" onclick="location.reload()">Refazer Diagn√≥stico</button>
    </div>
</div>

<script>
    let solicitante = "";
    let currentIdx = 0;
    let logicalAnswers = []; 
    let openAnswersData = {}; 

    const flow = [
        { type: "open", b: "DADOS DO PROCESSO", q: "Qual problema voc√™ quer solucionar?", key: "Problema_a_Solucionar" },
        { type: "open", b: "DADOS DO PROCESSO", q: "Qual seria o nome deste processo?", key: "Nome_do_Processo" },
        { type: "logic", b: "üî¥ BLOCO 1 ‚Äî VALOR E NECESSIDADE", q: "Q1. Este processo acontece com frequ√™ncia ou tem impacto relevante (risco, custo, cliente ou compliance)?" },
        { type: "logic", b: "üî¥ BLOCO 1 ‚Äî VALOR E NECESSIDADE", q: "Q2. Manter este processo de forma manual hoje gera mais problema do que benef√≠cio?" },
        { type: "logic", b: "üü† BLOCO 2 ‚Äî MATURIDADE DO PROCESSO", q: "Q3. A maioria das solicita√ß√µes segue as mesmas etapas, na mesma ordem?" },
        { type: "logic", b: "üü† BLOCO 2 ‚Äî MATURIDADE DO PROCESSO", q: "Q4. Pessoas diferentes executam esse processo de forma parecida?" },
        { type: "logic", b: "üü° BLOCO 3 ‚Äî NATUREZA DA DEMANDA", q: "Q5. O principal problema hoje √© receber solicita√ß√µes por v√°rios canais diferentes?" },
        { type: "open", b: "üü° BLOCO 3 ‚Äî NATUREZA DA DEMANDA", q: "Conte um pouco da dor que esse processo carrega atualmente", key: "Dor_do_Processo" },
        { type: "logic", b: "üü° BLOCO 3 ‚Äî NATUREZA DA DEMANDA", q: "Q6. As solicita√ß√µes entram em fila e algu√©m da equipe assume para atender?" },
        { type: "logic", b: "üü° BLOCO 3 ‚Äî NATUREZA DA DEMANDA", q: "Q7. O mais importante √© acompanhar prazos e saber quem est√° atendendo cada solicita√ß√£o?" },
        { type: "logic", b: "üü¢ BLOCO 4 ‚Äî FLUXO E ORQUESTRA√á√ÉO", q: "Q8. Ap√≥s a entrada, a solicita√ß√£o precisa ‚Äúpassar o bast√£o‚Äù entre pessoas ou √°reas at√© ser conclu√≠da?" },
        { type: "logic", b: "üü¢ BLOCO 4 ‚Äî FLUXO E ORQUESTRA√á√ÉO", q: "Q9. Esse fluxo precisa ser orquestrado, com controle claro de in√≠cio, meio e fim?" },
        { type: "logic", b: "üü¢ BLOCO 4 ‚Äî FLUXO E ORQUESTRA√á√ÉO", q: "Q10. As tarefas desse fluxo s√£o repetitivas e previs√≠veis na maior parte dos casos?" },
        { type: "logic", b: "üü¢ BLOCO 4 ‚Äî FLUXO E ORQUESTRA√á√ÉO", q: "Q11. √â necess√°rio gerar indicadores, hist√≥rico e rastreabilidade do processo?" },
        { type: "logic", b: "‚ö†Ô∏è BLOCO 5 ‚Äî AUTOCONSCI√äNCIA", q: "Q12. Se este processo fosse executado hoje sem sistema, voc√™ conseguiria explicar todo o fluxo por onde ele come√ßa, passa e termina?" },
        { type: "open", b: "‚ö†Ô∏è BLOCO 5 ‚Äî AUTOCONSCI√äNCIA", q: "Descreva um pouco sobre como √© esse processo hoje", key: "Como_Funciona_Hoje" }
    ];

    function startFlow() {
        solicitante = document.getElementById('userName').value;
        if (!solicitante.trim()) { alert("Informe seu nome."); return; }
        document.getElementById('step-start').classList.add('hidden');
        document.getElementById('step-questions').classList.remove('hidden');
        updateScreen();
    }

    function updateScreen() {
        if (currentIdx < flow.length) {
            const item = flow[currentIdx];
            document.getElementById('block-name').innerText = item.b;
            document.getElementById('question-text').innerText = item.q;
            
            if (item.type === "logic") {
                document.getElementById('area-sim-nao').classList.remove('hidden');
                document.getElementById('area-discursiva').classList.add('hidden');
            } else {
                document.getElementById('area-sim-nao').classList.add('hidden');
                document.getElementById('area-discursiva').classList.remove('hidden');
                document.getElementById('open-answer').value = "";
            }
        } else {
            showResult();
        }
    }

    function handleAnswer(val) {
        logicalAnswers.push(val);
        currentIdx++;
        updateScreen();
    }

    function handleOpenAnswer() {
        const val = document.getElementById('open-answer').value;
        if (!val.trim()) { alert("Por favor, responda √† pergunta."); return; }
        openAnswersData[flow[currentIdx].key] = val;
        currentIdx++;
        updateScreen();
    }

    function showResult() {
        document.getElementById('step-questions').classList.add('hidden');
        document.getElementById('step-result').classList.remove('hidden');
        
        const title = document.getElementById('result-title');
        const text = document.getElementById('result-text');
        const cal = document.getElementById('calendar-area');
        
        const q = (num) => logicalAnswers[num-1];
        let res = "";

        const allSim = logicalAnswers.every(ans => ans === true);
        const allNao = logicalAnswers.every(ans => ans === false);

        if (allSim || allNao) {
            res = "Redesenhar Processo";
            text.innerText = "Respostas muito uniformes detectadas. √â necess√°ria uma an√°lise consultiva para desenhar o fluxo antes de qualquer automa√ß√£o.";
            cal.classList.remove('hidden');
        } 
        else if (q(1) === false || q(2) === false) {
            res = "Manual / E-mail";
            text.innerText = "De acordo com as respostas, o volume ou impacto atual n√£o justifica o investimento em automa√ß√£o.";
        } 
        else if ((q(3) === false && q(4) === false) || q(12) === false || ((q(8) || q(9)) && (q(3) === false || q(4) === false))) {
            res = "Redesenhar Processo";
            text.innerText = "O fluxo atual est√° confuso ou inconsistente. Antes de automatizar, √© necess√°rio desenhar e padronizar as etapas.";
            cal.classList.remove('hidden');
        }
        else if (q(5) === true && q(6) === false && q(8) === false) {
            res = "Formul√°rio (Forms)";
            text.innerText = "A necessidade principal √© centralizar a entrada de dados.";
            cal.classList.remove('hidden');
        }
        else if (q(6) === true && q(7) === true && q(8) === false) {
            res = "Movidesk / Service Desk";
            text.innerText = "Cen√°rio focado em gest√£o de atendimento e prazos.";
            cal.classList.remove('hidden');
        }
        else if (q(3) && q(4) && q(8) && q(9) && q(10) && q(11) && q(12)) {
            res = "Zeev BPM";
            text.innerText = "Processo maduro e orquestrado identificado. Ideal para automa√ß√£o de fluxos via BPM.";
            cal.classList.remove('hidden');
        }
        else {
            res = "Redesenhar Processo";
            text.innerText = "N√£o foi poss√≠vel encaixar o processo em uma ferramenta espec√≠fica. Recomenda-se uma revis√£o do fluxo.";
            cal.classList.remove('hidden');
        }

        title.innerText = res;
        sendToFormspree(res);
    }

    async function sendToFormspree(resultLabel) {
        const url = "https://formspree.io/f/xlgjerob";
        let data = { Solicitante: solicitante, Resultado_Final: resultLabel, ...openAnswersData };
        logicalAnswers.forEach((a, index) => { data[`Logica_Q${index + 1}`] = a ? "SIM" : "N√ÉO"; });
        try {
            await fetch(url, { method: 'POST', headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' }, body: JSON.stringify(data) });
            document.getElementById('sending-status').innerText = "Diagn√≥stico enviado com sucesso.";
        } catch (e) { document.getElementById('sending-status').innerText = "Erro ao enviar dados."; }
    }
</script>

</body>
</html>

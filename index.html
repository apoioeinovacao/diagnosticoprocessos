<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagn√≥stico de Ferramentas e Processos</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, sans-serif; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
            background: #2C3E50; /* Azul Neutro */
            color: #333; 
        }
        .card { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); max-width: 600px; width: 90%; text-align: center; }
        .hidden { display: none; }
        h2 { color: #2C3E50; margin-bottom: 20px; font-weight: bold; }
        p { line-height: 1.6; font-size: 1.1em; color: #444; }
        input { padding: 12px; width: 90%; margin-bottom: 20px; border: 2px solid #ddd; border-radius: 6px; font-size: 16px; }
        .btn-group { display: flex; justify-content: center; gap: 15px; margin-top: 20px; }
        button { padding: 15px 30px; cursor: pointer; border: none; border-radius: 6px; font-weight: bold; font-size: 16px; transition: 0.3s; }
        .btn-next { background: #2C3E50; color: white; width: 100%; }
        .btn-sim { background: #1D8348; color: white; flex: 1; }
        .btn-nao { background: #A93226; color: white; flex: 1; }
        #result-text { text-align: left; background: #f8f9fa; padding: 25px; border-left: 6px solid #2C3E50; margin-top: 20px; border-radius: 4px; }
        .progress { font-size: 0.9em; color: #888; margin-bottom: 10px; font-weight: bold; }
        .block-tag { font-size: 0.75em; color: #2C3E50; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }
    </style>
</head>
<body>

    <div class="card">
        <div id="step-name">
            <h2>Diagn√≥stico de Ferramentas</h2>
            <p>Vamos descobrir a melhor ferramenta para sua necessidade. Responda as perguntas a seguir com SIM ou N√ÉO de acordo com sua necessidade.</p>
            <input type="text" id="userName" placeholder="Informe seu nome completo">
            <button class="btn-next" onclick="startFlow()">Come√ßar</button>
        </div>

        <div id="step-questions" class="hidden">
            <div id="block-name" class="block-tag"></div>
            <div id="progress" class="progress"></div>
            <h3 id="question-text" style="min-height: 100px; display: flex; align-items: center; justify-content: center;">...</h3>
            <div class="btn-group">
                <button class="btn-sim" onclick="handleAnswer(true)">Sim</button>
                <button class="btn-nao" onclick="handleAnswer(false)">N√£o</button>
            </div>
        </div>

        <div id="step-result" class="hidden">
            <h2 id="result-title"></h2>
            <div id="result-text"></div>
            
            <div id="calendar-area" class="hidden">
                <p style="margin-top: 25px; font-weight: bold;">Deseja detalhar este projeto?</p>
                <a href="https://outlook.office.com/bookwithme/user/fec3fc9171ab43869839ccfbf768b3e9@goldpao.com/meetingtype/fvmFuyerekKxbcV2HkZ2lQ2?anonymous&ismsaljsauthenabled&ep=mlink" target="_blank">
                    <button class="btn-next">Agendar reuni√£o com Alexandre</button>
                </a>
            </div>
            
            <p id="sending-status" style="font-size: 11px; color: #999; margin-top: 20px;"></p>
            <button class="btn-next" style="margin-top:20px; background: #666;" onclick="location.reload()">Refazer Diagn√≥stico</button>
        </div>
    </div>

    <script>
        let solicitante = "";
        let currentQuestion = 0;
        let answers = [];

        const questions = [
            { b: "üî¥ BLOCO 1 ‚Äî VALOR E IMPACTO", q: "O volume ou a criticidade das solicita√ß√µes justifica o uso de um sistema dedicado?" },
            { b: "üî¥ BLOCO 1 ‚Äî VALOR E IMPACTO", q: "Manter esse processo de forma manual hoje gera mais problema do que benef√≠cio?" },
            { b: "üî¥ BLOCO 1 ‚Äî VALOR E IMPACTO", q: "Esse processo impacta clientes externos, auditorias ou √°reas cr√≠ticas da empresa?" },
            { b: "üü† BLOCO 2 ‚Äî MATURIDADE DO PROCESSO", q: "A maioria das solicita√ß√µes segue as mesmas etapas, na mesma ordem?" },
            { b: "üü† BLOCO 2 ‚Äî MATURIDADE DO PROCESSO", q: "Pessoas diferentes executam esse trabalho de forma parecida?" },
            { b: "üü° BLOCO 3 ‚Äî NATUREZA DA DEMANDA", q: "As solicita√ß√µes entram em fila e algu√©m assume para tratar?" },
            { b: "üü° BLOCO 3 ‚Äî NATUREZA DA DEMANDA", q: "√â importante saber, a qualquer momento, quem est√° atendendo cada solicita√ß√£o?" },
            { b: "üü° BLOCO 3 ‚Äî NATUREZA DA DEMANDA", q: "O sucesso depende mais de cumprir prazos (SLA) do que de como as etapas s√£o executadas?" },
            { b: "üü¢ BLOCO 4 ‚Äî CONTROLE DO FLUXO", q: "O sistema precisa impedir o avan√ßo se alguma regra n√£o for cumprida?" },
            { b: "üü¢ BLOCO 4 ‚Äî CONTROLE DO FLUXO", q: "O sistema precisa avisar automaticamente quando uma etapa termina?" },
            { b: "üü¢ BLOCO 4 ‚Äî CONTROLE DO FLUXO", q: "Depois de recebida, a solicita√ß√£o depende de uma sequ√™ncia fixa de etapas?" },
            { b: "üü¢ BLOCO 4 ‚Äî CONTROLE DO FLUXO", q: "Mesmo sem sistema, esse processo j√° funciona de forma previs√≠vel?" }
        ];

        function startFlow() {
            solicitante = document.getElementById('userName').value;
            if (!solicitante.trim()) { alert("Informe seu nome."); return; }
            document.getElementById('step-name').classList.add('hidden');
            document.getElementById('step-questions').classList.remove('hidden');
            updateQuestion();
        }

        function updateQuestion() {
            if (currentQuestion < questions.length) {
                document.getElementById('block-name').innerText = questions[currentQuestion].b;
                document.getElementById('progress').innerText = `Quest√£o ${currentQuestion + 1} de 12`;
                document.getElementById('question-text').innerText = questions[currentQuestion].q;
            } else { showResult(); }
        }

        function handleAnswer(val) {
            answers.push(val);
            currentQuestion++;
            updateQuestion();
        }

        async function sendToFormspree(resultLabel) {
            const url = "https://formspree.io/f/xlgjerob";
            let data = { Solicitante: solicitante, Resultado: resultLabel };
            questions.forEach((item, index) => {
                data[`Q${index + 1}_${item.q.substring(0, 30)}...`] = answers[index] ? "SIM" : "N√ÉO";
            });

            try {
                await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
                    body: JSON.stringify(data)
                });
                document.getElementById('sending-status').innerText = "Diagn√≥stico enviado com sucesso.";
            } catch (e) { }
        }

        function showResult() {
            document.getElementById('step-questions').classList.add('hidden');
            document.getElementById('step-result').classList.remove('hidden');
            
            const title = document.getElementById('result-title');
            const text = document.getElementById('result-text');
            const cal = document.getElementById('calendar-area');

            const q = (num) => answers[num-1];
            let res = "";

            // --- L√ìGICA FINAL ---

            // üü§ MANUAL / E-MAIL (Priorit√°rio)
            if (q(1) === false && q(2) === false && q(3) === false) {
                res = "Manual / E-mail";
                title.innerText = res;
                text.innerHTML = "De acordo com as respostas, n√£o justifica nenhum tipo de automa√ß√£o para o processo ou tarefa.";
            }
            // ‚ö†Ô∏è AVALIA√á√ÉO CONSULTIVA (Inconsist√™ncia antes dos demais)
            else if (( (q(9) || q(10)) && q(11) === false ) || ( q(8) && q(11) === false && q(6) === false )) {
                res = "Avalia√ß√£o Consultiva";
                title.innerText = res;
                text.innerHTML = "As respostas indicam uma inconsist√™ncia l√≥gica ou cen√°rio h√≠brido (mistura de rigidez com variabilidade). √â necess√°ria uma an√°lise humana para definir o caminho.";
                cal.classList.remove('hidden');
            }
            // üü¢ ZEEV BPM (Exce√ß√£o Qualificada)
            else if (q(1) && q(2) && q(3) && q(4) && q(5) && q(11) && q(12) && (q(9) || q(10))) {
                res = "Zeev BPM";
                title.innerText = res;
                text.innerHTML = "Identificada necessidade de fluxo fixo, controlado e maduro. O processo justifica o uso de orquestra√ß√£o via BPM.";
                cal.classList.remove('hidden');
            }
            // üî¥ REDESENHAR
            else if (q(4) === false && q(5) === false) {
                res = "Redesenhar antes de automatizar";
                title.innerText = res;
                text.innerHTML = "O fluxo de trabalho ainda √© inexistente ou totalmente inconsistente. √â necess√°rio desenhar o processo antes de pensar em sistema.";
                cal.classList.remove('hidden');
            }
            // üü† MELHORAR PROCESSO
            else if (q(4) === true && q(5) === false) {
                res = "Melhorar processo";
                title.innerText = res;
                text.innerHTML = "O fluxo existe, mas a execu√ß√£o √© inconsistente entre os envolvidos. Recomenda-se padronizar a opera√ß√£o.";
                cal.classList.remove('hidden');
            }
            // üü£ MOVIDESK / SERVICE DESK
            else if (q(6) && q(7) && q(11) === false) {
                res = "Movidesk / Service Desk";
                title.innerText = res;
                text.innerHTML = "Cen√°rio ideal para gest√£o de atendimento e prazos. O foco √© gerenciar a fila e o status das solicita√ß√µes.";
                cal.classList.remove('hidden');
            }
            // üîµ FORMS
            else if (q(1) && q(4) === false && q(6) === false && q(11) === false) {
                res = "Forms";
                title.innerText = "Microsoft Forms";
                text.innerHTML = "A centraliza√ß√£o da entrada √© suficiente. O processo exige tratamento individualizado e n√£o possui fluxo fixo.";
                cal.classList.remove('hidden');
            }
            // FALLBACK
            else {
                res = "Avalia√ß√£o Consultiva";
                title.innerText = res;
                text.innerHTML = "Cen√°rio com particularidades espec√≠ficas detectado. Agende uma conversa para definirmos a arquitetura ideal.";
                cal.classList.remove('hidden');
            }

            sendToFormspree(res);
        }
    </script>
</body>
</html>
